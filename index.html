<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="description" content="ูุณุงุจูุฉ ูุนูููุงุช ุชูุงุนููุฉ ูุงุฎุชุจุงุฑ ุซูุงูุชู ูู ูุณุชููุงุช ูุชุนุฏุฏุฉ.">
  <title>ูุณุงุจูุฉ ุงููุนูููุงุช</title>

  <link rel="icon" type="image/png" href="https://em-content.zobj.net/thumbs/120/apple/354/brain_1f9e0.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
  <link rel="stylesheet" href="style.css">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "VideoGame",
    "name": "ูุณุงุจูุฉ ุงููุนูููุงุช",
    "description": "ูุนุจุฉ ูุณุงุจูุฉ ุชูุงุนููุฉ ูุงุฎุชุจุงุฑ ุงููุนูููุงุช ูู ูุณุชููุงุช ูุชุนุฏุฏุฉ.",
    "applicationCategory": "GameApplication",
    "operatingSystem": "Web Browser",
    "author": {
      "@type": "Person",
      "name": "MS AbuQusay"
    }
  }
  </script>
</head>
<body data-theme="dark">
  <noscript>ูุฐู ุงููุนุจุฉ ุชุชุทูุจ ุชูุนูู JavaScript.</noscript>

  <div id="toast-container" class="toast-container" aria-live="assertive"></div>

  <!--  div#reportErrorFab (Removed as requested) -->

  <div id="loader" class="screen active" role="status" aria-label="ุฌุงุฑู ุงูุชุญููู">
    <div class="spinner" aria-hidden="true"></div>
    <p id="loaderText" class="game-subtitle" style="margin-top: 1rem;">ุฌุงุฑู ุชุญููู ุงููุนุจุฉ...</p>
  </div>

  <div id="startScreen" class="screen">
    <div class="content-box">
      <header class="screen-header">
        <h1 class="game-title">๐ง ูุณุงุจูุฉ ุงููุนูููุงุช</h1>
        <p class="game-subtitle">ุงุฎุชุจุฑ ูุฏุฑุงุชู ูู ูุณุงุจูุฉ ุชูุงุนููุฉ ุดููุฉ</p>
      </header>
      <div class="button-group">
          <button id="startBtn" class="btn-main" data-action="showAvatarScreen">ุงุจุฏุฃ ุงููุนุจ</button>
          <button data-action="showLeaderboard" class="btn-secondary">ููุญุฉ ุงูุตุฏุงุฑุฉ</button>
      </div>

      <div class="theme-palette-picker">
          <label for="paletteSelect" class="sr-only">ุงุฎุชูุงุฑ ููุท ุงูุฃููุงู</label>
          <select id="paletteSelect">
              <option value="classic" selected>๐จ ุงูููุงุณููู</option>
              <option value="aqua">๐ ููุฑูุฒู</option>
              <option value="neon">๐ ูููู</option>
              <option value="earth">๐พ ุชุฑุงุจู</option>
          </select>
      </div>
    </div>
  </div>

  <div id="avatarScreen" class="screen">
    <div class="content-box">
      <header class="screen-header"><h2>ุงุฎุชุฑ ุตูุฑุชู ุงูุฑูุฒูุฉ</h2></header>
      <div class="avatar-grid" role="group" aria-label="ุฎูุงุฑุงุช ุงูุตูุฑ ุงูุฑูุฒูุฉ"></div>
      <div class="button-group">
        <button id="confirmAvatarBtn" class="btn-main" disabled data-action="showNameEntryScreen">ุงูุชุงูู</button>
      </div>
    </div>
  </div>

  <div id="nameEntryScreen" class="screen">
    <div class="content-box">
      <header class="screen-header"><h2>ุฃุฏุฎู ุงุณูู</h2></header>
      <div class="form-group">
        <label for="nameInput" class="sr-only">ุงุณู ุงููุงุนุจ</label>
        <input type="text" id="nameInput" placeholder="ูุซูุง: ุนุจุฏ ุงููู" maxlength="25" autocomplete="name" aria-required="true" aria-describedby="nameError">
        <div id="nameError" class="error-message" aria-live="polite"></div>
      </div>
      <div class="button-group">
        <button id="confirmNameBtn" class="btn-main" disabled data-action="confirmName">ุชุฃููุฏ ุงูุฅุณู</button>
      </div>
    </div>
  </div>

  <!-- div#instructionsScreen (Removed as requested) -->

  <section id="helpGrid" class="help-grid"></section>

  <main id="gameContainer" class="screen">
    <div class="top-bar">
      <button class="end-quiz-btn" aria-label="ุฅููุงุก ุงููุณุงุจูุฉ" data-action="showConfirmExitModal">๐ช ุฅููุงุก</button>
      <div class="level-progress">
        <div class="level-indicator" data-level="easy" data-tooltip="ุงููุณุชูู ุงูุณูู">1</div>
        <div class="level-indicator" data-level="medium" data-tooltip="ุงููุณุชูู ุงููุชูุณุท">2</div>
        <div class="level-indicator" data-level="hard" data-tooltip="ุงููุณุชูู ุงูุตุนุจ">3</div>
        <div class="level-indicator" data-level="impossible" data-tooltip="ุงููุณุชูู ุงููุณุชุญูู">4</div>
      </div>
      <button class="theme-toggle-btn" aria-label="ุชุจุฏูู ูุถุน ุงูุณุทูุน ูุงูุธูุงู" data-action="toggleTheme">โ๏ธ</button>
    </div>

    <header class="game-header">
      <div class="player-info">
        <div class="player-main">
          <img id="playerAvatar" src="" alt="ุงูุตูุฑุฉ ุงูุฑูุฒูุฉ ููุงุนุจ" loading="lazy" decoding="async">
          <div class="player-details">
            <span id="playerName" aria-label="ุงุณู ุงููุงุนุจ"></span>
            <span id="playerId" class="player-id"></span>
          </div>
        </div>
        <div class="player-stats">
          <div class="stat-item">ุงูููุงุท: <strong id="currentScore" aria-live="polite">100</strong></div>
          <!-- Changed: Removed ' / 3' to reflect unlimited wrong answers -->
          <div class="stat-item">ุงูุฃุฎุทุงุก: <strong id="wrongAnswersCount" aria-live="assertive">0</strong></div>
          <div class="stat-item">ุงูุชุฎุทู: <strong id="skipCount">0</strong></div>
        </div>
      </div>

      <div class="helpers" aria-label="ุฎูุงุฑุงุช ุงููุณุงุนุฏุฉ">
        <button class="helper-btn" data-type="fiftyFifty" aria-describedby="fiftyFiftyDesc"><span class="sr-only">ูุณุงุนุฏุฉ 50:50</span>50:50<span class="helper-cost">(100)</span></button>
        <button class="helper-btn" data-type="freezeTime" aria-describedby="freezeTimeDesc"><span class="sr-only">ูุณุงุนุฏุฉ ุชุฌููุฏ ุงูููุช</span>โ๏ธ 10ุซ<span class="helper-cost">(100)</span></button>
        <button class="helper-btn" data-type="skipQuestion" aria-describedby="skipQuestionDesc"><span class="sr-only">ุชุฎุทู ุงูุณุคุงู</span>โญ๏ธ ุชุฎุทู<span id="skipCost" class="helper-cost">(ูุฌุงููุฉ)</span></button>

        <span id="fiftyFiftyDesc" class="sr-only">ูุฒูู ุฎูุงุฑูู ุฎุงุทุฆูู. ุงูุงุณุชุฎุฏุงู ูุฑุฉ ูุงุญุฏุฉ ููู ุฌููุฉ. ุงูุชูููุฉ 100 ููุทุฉ.</span>
        <span id="freezeTimeDesc" class="sr-only">ูููู ุงููุคูุช 10 ุซูุงูู. ุงูุงุณุชุฎุฏุงู ูุฑุฉ ูุงุญุฏุฉ ููู ุฌููุฉ. ุงูุชูููุฉ 100 ููุทุฉ.</span>
        <span id="skipQuestionDesc" class="sr-only">ุชุฎุทู ุงูุณุคุงู ุงูุญุงูู. ูุฌุงููุฉ ุชูุงูุงู.</span>
      </div>
    </header>

    <div class="timer-container" aria-label="ูุคูุช ุงูุณุคุงู">
      <div class="timer-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100"></div>
      <span id="timer" class="timer-text">30</span>
    </div>

    <div class="main-content">
      <section class="question-box" aria-labelledby="questionCounter">
        <div class="level-badge" id="currentLevelBadge">ุณูู</div>
        <h3 id="questionCounter">ุงูุณุคุงู 1 ูู 5</h3>
        <p id="questionText" aria-live="polite"></p>
      </section>
      <section class="options-container" aria-labelledby="questionText">
        <div class="options-grid" role="group" aria-label="ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ"></div>
      </section>
    </div>
  </main>

  <div id="levelCompleteScreen" class="screen">
    <div class="content-box">
      <header class="screen-header"><h2 id="levelCompleteTitle">๐ ุฃูููุช ุงููุณุชูู!</h2></header>
      <div class="level-stats">
        <p>ุงูููุงุท ุงูุญุงููุฉ: <strong id="levelScore"></strong></p>
        <p>ุนุฏุฏ ุงูุฃุฎุทุงุก: <strong id="levelErrors"></strong></p>
        <p>ุงูุฃุณุฆูุฉ ุงูุตุญูุญุฉ: <strong id="levelCorrect"></strong></p>
      </div>
      <div class="button-group">
        <button class="btn-main" data-action="nextLevel">ุงููุณุชูู ุงูุชุงูู</button>
        <button class="btn-secondary" data-action="endGame">ุงูุงูุณุญุงุจ ูุนุฑุถ ุงููุชุงุฆุฌ</button>
      </div>
    </div>
  </div>

  <div id="endScreen" class="screen screen--align-top">
    <div class="content-box">
      <header class="screen-header"><h2>๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ๐</h2></header>
      <div class="final-stats">
        <p>โ๏ธ ุงูุงุณู: <strong id="finalName"></strong></p>
        <p>๐ ุงููุนุฑูู: <strong id="finalId"></strong></p>
        <p>๐ข ุฑูู ุงููุญุงููุฉ: <strong id="finalAttemptNumber"></strong></p>
        <p>โ ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ: <strong id="finalCorrect"></strong></p>
        <p>โ ุงูุฅุฌุงุจุงุช ุงูุฎุงุทุฆุฉ: <strong id="finalWrong"></strong></p>
        <p>โญ๏ธ ูุฑุงุช ุงูุชุฎุทู: <strong id="finalSkips"></strong></p>
        <p>โญ ุงูููุงุท ุงูููุงุฆูุฉ: <strong id="finalScore"></strong></p>
        <p>โฑ๏ธ ุงูููุช ุงููุณุชุบุฑู: <strong id="totalTime"></strong></p>
        <p>๐ ุงููุณุชูู ุงูุฐู ูุตูุช ุฅููู: <strong id="finalLevel"></strong></p>
        <p>๐ฏ ูุณุจุฉ ุงูุฏูุฉ: <strong id="finalAccuracy"></strong></p>
        <p>โณ ูุชูุณุท ููุช ุงูุฅุฌุงุจุฉ: <strong id="finalAvgTime"></strong></p>
        <div class="performance-rating"><span>ุฃุฏุงุคู: </span><strong id="performanceText"></strong></div>
      </div>
      <section class="share-section">
        <h3>๐ข ูุดุงุฑูุฉ ุงููุชุงุฆุฌ</h3>
        <div class="share-buttons">
          <button class="share-btn x" data-action="shareOnX">X</button>
          <button class="share-btn instagram" data-action="shareOnInstagram">Instagram</button>
        </div>
      </section>

      <p id="retryHint" style="display:none; text-align:center; margin-top:1rem;">
        โณ ููููู ุงููุญุงููุฉ ูุฌุฏุฏูุง ุจุนุฏ <b id="retryCountdown">30</b> ุซุงููุฉ.
      </p>
      
      <div class="button-group">
         <button id="playAgainBtn" class="btn-main" data-action="playAgain">ุฃุนุฏ ุงููุนุจ</button>
         <button class="btn-secondary" data-action="showLeaderboard">ููุญุฉ ุงูุตุฏุงุฑุฉ</button>
        <button class="btn-secondary" data-action="showStartScreen">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
      </div>
    </div>
  </div>

  <div id="leaderboardScreen" class="screen screen--align-top">
    <div class="content-box">
      <header class="screen-header"><h2>๐ ููุญุฉ ุงูุตุฏุงุฑุฉ ๐</h2></header>
      
      <div class="lb-filters">
      <div id="lbLastUpdated" class="lb-last-updated" style="text-align:center;opacity:.8;font-size:.9rem;margin-top:.25rem"></div>
        <select id="lbMode" aria-label="ููุท ุชุฑุชูุจ ุงูููุญุฉ">
          <option value="all">ุงููู</option>
          <option value="best" selected>ุฃูุถู ูุชูุฌุฉ</option>
          <option value="attempt">ุฑูู ุงููุญุงููุฉ</option>
          <option value="accuracy">ุฃุนูู ุฏูุฉ</option>
          <option value="time">ุฃูู ููุช</option>
         </select>
        <select id="lbAttempt" disabled aria-label="ุงุฎุชุฑ ุฑูู ุงููุญุงููุฉ">

        </select>
      </div>
      
      <div id="leaderboardContent" aria-live="polite"></div>
      <div class="button-group">
        <button class="btn-secondary" data-action="showStartScreen">ุงูุนูุฏุฉ</button>
      </div>
    </div>
  </div>

  <div id="confirmExitModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="confirmExitTitle">
    <div class="modal-content">
      <h3 id="confirmExitTitle">ุฅููุงุก ุงููุณุงุจูุฉ</h3>
      <p>ุณูุชู ุญูุธ ููุงุทู ุงูุญุงููุฉ. ูู ุชุฑุบุจ ูู ุงููุชุงุจุนุฉุ</p>
      <div class="modal-buttons">
        <button class="btn-main" data-action="endGame">ูุนู</button>
        <button class="btn-secondary" data-action="closeModal" data-modal-id="confirmExitModal">ูุง</button>
      </div>
    </div>
  </div>

  <!-- div#advancedReportModal (Removed as requested) -->

  <div id="avatarEditorModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="avatarEditorTitle">
    <div class="modal-content">
      <h3 id="avatarEditorTitle">ุชุนุฏูู ุงูุตูุฑุฉ ุงูุฑูุฒูุฉ</h3>
      <div id="image-editor-container">
        <img id="image-to-crop" src="" alt="ุตูุฑุฉ ููุชูููู/ุงููุต">
      </div>
      <div class="modal-buttons">
        <button class="btn-main" data-action="saveCroppedAvatar">ุญูุธ ุงูุตูุฑุฉ</button>
        <button class="btn-secondary" data-action="closeModal" data-modal-id="avatarEditorModal">ุฅูุบุงุก</button>
      </div>
    </div>
  </div>

  <div id="playerDetailsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="playerDetailsTitle">
    <div class="modal-content">
      <header class="player-details-header">
        <img id="detailsAvatar" src="" alt="ุตูุฑุฉ ุงููุงุนุจ ุงูุฑูุฒูุฉ" class="player-details-avatar">
        <h3 id="playerDetailsTitle">ุชูุงุตูู ุงููุงุนุจ</h3>
        <span id="detailsName"></span>
        <span id="detailsPlayerId" class="player-id"></span>
      </header>
      <div id="playerDetailsContent" class="player-details-body"></div>
      <div class="modal-buttons">
        <button class="btn-secondary" data-action="closeModal" data-modal-id="playerDetailsModal">ุฅุบูุงู</button>
      </div>
    </div>
  </div>

  <!-- Help FAB + Drawer -->
  <div id="helpBackdrop" class="help-backdrop" hidden></div>
    <!-- Task 1: Changed ID, class, and icon for the new Robot FAB -->
    <button id="robotHelpFab" class="robot-fab" aria-label="ุฅุฑุดุงุฏุงุช ุงููุนุจ" aria-expanded="false">
        <video autoplay loop muted playsinline class="robot-video">
            <source src="https://raw.githubusercontent.com/AbuQusayMS/AQ_0/main/audio/robot.webm" type="video/webm">
        </video>
    </button>
    <aside id="helpDrawer" class="help-drawer" aria-hidden="true" aria-label="ุฅุฑุดุงุฏุงุช ุงููุนุจ" tabindex="-1">
    <header class="help-header">
    <h3>ุฅุฑุดุงุฏุงุช ุงููุนุจ</h3>
    <button class="help-close" data-help="close" aria-label="ุฅุบูุงู">ร</button>
    </header>
    <div id="helpBody" class="help-body" role="region" aria-live="polite"></div>
    <footer class="help-footer">
    <button class="help-btn" data-help="prev" aria-label="ุงูุณุงุจู">โฌ๏ธ ุงูุณุงุจู</button>
    <span id="helpProgress" class="help-progress">1/4</span>
    <button class="help-btn" data-help="next" aria-label="ุงูุชุงูู">ุงูุชุงูู โก๏ธ</button>
    </footer>
    </aside>

  <!-- ูุงูุฐุฉ ุงููุณุงุนุฏ ุงูุฌุฏูุฏุฉ -->
  <dialog id="robotAssistDialog" aria-labelledby="robotAssistTitle">
      <section class="assist-wrap" role="document">
          <header class="assist-header">
              <h3 id="robotAssistTitle">ุงููุณุงุนุฏ ุงูุฐูู</h3>
              <button class="assist-close" aria-label="ุฅุบูุงู">โ</button>
          </header>

          <p class="assist-subtitle">ูุตุงุฆุญ ุณุฑูุนุฉ ูุจู ุงูุจุฏุก</p>
  
          <div id="assistGrid" class="assist-grid" aria-live="polite" aria-busy="false"></div>

      </section>
  </dialog>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js" defer></script>

  <script src="script.js?v=19" defer></script>
</body>
</html>
